var AppSumstat = angular.module("app.sumstat", [
	"ui.router",
	"LocalStorageModule",
	"AppFilters"
])

.config([
	"$stateProvider",
	"$httpProvider",
	"$urlRouterProvider",
	"$locationProvider",
	function(t,e,s,r){
		_log("app.sumstat config ...")
		t.state("sumstat",{
			"abstract":!0,
			url:"/sumstat",
			template:'<div class="ui-main-conteiner" ui-view></div>',
			resolve:[
			"$q",
			"$rootScope",
			"$state",
			"$stateParams",
			"Api",
			function(t,e,s,r,a){
				var i=t.defer();
				_log("AppSumstat base state resolve ... ");
				e.userList=[];
				e.userList_keyLink={};
				e.activeUsers=[];
				e.blockedUsers=[];

				var u=function(t){
					_log("Api Request:",t);
					var s=Object.keys(t.list).length,r=[];
					if(e.userCount=s,_log("$rootScope.userCount: "+Object.keys(t.list).length),t.list&&s){
						for(var a in t.list){
							var u=t.list[a];
							e.userList_keyLink[a]=r.push(u)-1,
							"0"==u.BLOCKED?e.blockedUsers.push(u.ID):e.activeUsers.push(u.ID)
						}
						e.userList=r
					}

					e.$emit("changeUserList"),i.resolve()
				};

				return _log("Api.request ...",a),a.request({action:"account.sumstat"}).then(u),i.promise}]
	}).state("sumstat.list",{
		url:"",
		templateUrl:"pages/sumstat/list/template.html",
		controller:"SumstatListCtrl"
	}).state("sumstat.view",{
		"abstract":!0,
		url:"/view/:userId",
		templateUrl:"pages/sumstat/user_view/template.html",
		controller:[
			"$scope",
			"$stateParams",
			function(t,e){var s=t.userList_keyLink[e.userId];t.user=t.userList[s]}]}).state("sumstat.view.detail",{url:"",templateUrl:"pages/sumstat/user_view/card/template.html",controller:"SumstatUserViewCtrl"})}]);